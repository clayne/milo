

#include <iostream>

#include <milo/concepts.h>
#include <milo/container.h>
#include <milo/literals.h>

#include <milo/crypto/hash/sha.h>
#include <milo/crypto/mac/hmac.h>
#include <milo/crypto/kdf/pbkdf.h>
#include <milo/crypto/kdf/test.h>


using namespace milo::literals;

struct test_vector
{
    const size_t id;
    
    const milo::container::chars_const_view_dynamic ikm;
    
    const milo::container::chars_const_view_dynamic salt;
    
    const uint32_t iterations;
    
    const milo::container::chars_const_view_dynamic key;
};

constexpr milo::container::array<test_vector, 40> test_vectors
    {
        test_vector
            {
                .id = 1,
                .ikm =
                ""_cv,
                .salt =
                ""_cv,
                .iterations = 10,
                .key =
                "\xa5\xdf\x20\x56\x47\x67\xac\x09\xd2\x63\x9f\xfb\x66\xdd\x49\xd9"
                "\x0e\x53\xce\x38\xa6\xfd\xc4\x86\x52\xb8\x49\x13\xfc\xfb\x8a\xc7"
                "\xfd\x23\x90\x5f\xc9\xcc\x58\xf0\xcc\x14\xe8\x9f\xc4\xef\x8b\x45"
                "\xed\x3c\x86\x6f\xa6\x4a\xfd\xb3\xc1\x95\xf3\x85\x91\xbc\x65\x20"
                "\x83\x0b\xeb\x77\xc6\xf2\x47\x7a\x11\xcf\xbc\xe0\x06\x81\x02\x6c"
                "\x9c\xa9\x31\x78\xb3\x53\x55\xc1\x79\x4a\xf9\x36\x15\x0a\x40\x61"
                "\xfb\x65\x65\x81\x2f\x6e\x0f\x8f\x9e\xaa\x77\x8d\x07\x6d\x53\x76"
                "\x5a\xbe\x46\x83\x92\x4b\xf8\x03\xed\x83\x51\xb7\x37\xff\xd2\x17"_cv
            },
        test_vector
            {
                .id = 2,
                .ikm =
                ""_cv,
                .salt =
                ""_cv,
                .iterations = 20,
                .key =
                "\xa8\x82\xf1\x76\x2a\x5e\x24\xd6\x5c\x67\xb4\xdd\xee\xd7\x0e\x7e"
                "\x74\xbe\x48\x4a\xf0\x63\x69\x1f\x56\xd2\xdd\x05\xa5\xc0\x08\x00"
                "\xb0\x88\x45\x43\x0e\x5a\x81\x1d\x09\x6c\x1d\x8b\x9f\xbe\xf0\x79"
                "\x5a\xaf\xff\xba\x80\x66\x7d\x0d\xbe\x9a\x1b\x17\xe4\x54\x20\x70"
                "\x72\x55\xda\x7c\xa3\xc1\xb1\x85\x25\x0d\x80\x9f\xcd\xc8\x43\x44"
                "\x5a\xe7\x33\xa3\xb0\x01\x60\x6d\x97\x89\x7d\xf4\xcc\xef\x4e\x9a"
                "\x06\x5f\x88\x58\xa3\xe7\x62\xec\xcc\xf9\x59\xc5\x28\xe9\xf1\x42"
                "\x0c\x3b\x68\xc9\xd4\x36\x22\x12\xd1\xb9\x7f\xe1\xb6\x35\xa2\x7d"_cv
            },
        test_vector
            {
                .id = 3,
                .ikm =
                "\x07\x80\xe2\x29\x98\xe8\xe3\xdf\x24\x93\x02\x24\x15\x08\x5c\x66"
                "\x8f\x0b\x2a\x0c\xdb\xd9\x2d\xda\x73\x47\x12\x0d\x65\x8e\xcc\x5d"_cv,
                .salt =
                "\x59\x3f\xff\xfc\x2e\xcb\xc2\x1f\x2a\x6a\x8e\xb5\xf4\x40\x8e\xbc"
                "\xc0\xac\xea\x68\xe2\xb7\x4b\xd7\x35\x60\x36\x5a\x3b\xe9\x45\xcf"_cv,
                .iterations = 20,
                .key =
                "\xec\x82\xbe\x63\xc0\x21\x58\x6f\xb6\x6b\x65\xd0\xde\x7b\xc7\x6a"
                "\xb3\x20\x23\x33\x95\xfa\x9c\x1f\xe3\x2b\xa2\x0f\x32\x4b\xf5\x50"
                "\x60\x3d\x88\x29\xa5\x83\x38\xc9\x10\xae\x83\x67\x5e\x6a\xb0\x53"
                "\x28\xbd\x9d\xea\x6a\x98\x57\x2e\x05\xd3\x0f\xb3\x00\xd8\x88\xef"
                "\x9b\x87\x83\x5e\x14\x16\xe5\x5e\xfb\x0d\x6e\x59\xec\x6a\x2a\x0d"
                "\xa8\xd1\xae\xd6\x67\x06\xc9\xbf\x8f\xb7\x5f\x37\x88\xba\x99\xa0"
                "\xa6\x55\x94\x32\xd4\x0a\xab\xa2\x13\x8a\x91\xde\x33\xad\xa4\x16"
                "\xe4\x51\x82\x3a\x3c\x34\x79\x79\x3a\x84\x07\xf7\x0c\x59\x5d\x8f"_cv
            },
        test_vector
            {
                .id = 4,
                .ikm =
                "\x8c\xd9\x89\xcf\x01\x09\x0b\x13\x9b\xee\xbe\x74\xe3\xc9\x79\xb4"
                "\x5f\x14\x1e\xed\x5b\x9e\xe4\x73\x09\x2b\x19\x76\x66\xbd\x66\x2b"_cv,
                .salt =
                "\x0b\x07\x27\x97\xa5\x84\xb2\xbb\xb4\xdc\xdd\xb5\x82\x22\x6a\xa7"
                "\xd9\x83\xd5\xfd\xd0\xbb\x31\x47\x2f\x45\xbc\xfb\xdb\x91\x20\xb5"_cv,
                .iterations = 21,
                .key =
                "\x76\xe8\xb8\xb3\x44\x85\x04\x8e\x9a\x49\xa8\xd4\xd0\x9a\xe6\x0d"
                "\x46\x8a\x0d\x1b\xc3\x42\x41\x52\x69\x32\xa9\x17\xb3\x6c\x65\x1e"
                "\x9b\x18\xab\x33\xcc\x2a\x40\x10\x29\x90\x7e\x1d\x96\xac\x79\x1a"
                "\x84\x7e\xfc\x9e\xb4\x8a\xae\xc1\x31\xd4\xed\x77\xa4\x0a\x0e\xb9"
                "\x28\xa9\x08\x90\xe4\x74\xd6\xdc\xe9\x25\xd4\x40\x68\x18\xcd\xbc"
                "\x0e\xf4\x93\x25\xba\x8e\xca\xd1\x27\x07\x7c\x5a\xa9\xe2\x55\x38"
                "\x0c\xb5\x00\x90\xfe\xb5\xb8\xef\x3c\x68\xae\xa5\xb1\x32\x8d\xa6"
                "\x8c\xe8\x9f\x43\x32\x45\x82\x69\x1d\x22\x00\x11\x95\x71\x5e\x98"_cv
            },
        test_vector
            {
                .id = 5,
                .ikm =
                "\x46\xa8\xf2\x5d\x4e\x94\x14\x4b\x30\xa7\xd7\x5f\xfa\x0b\x19\x01"
                "\xf0\x8a\x7f\x8d\x0a\x5f\xb0\x80\x23\xb2\x66\xed\x9b\x5f\x6f\xf1"_cv,
                .salt =
                "\x0c\x68\x6f\x45\x5d\x6e\x8c\xc2\x3f\xd0\xe5\xba\x9a\x9d\x9c\x77"
                "\x9f\x9e\x7f\xc2\xc9\x43\x59\x80\xf1\x0b\xa2\xab\x29\x5e\x65\x1e"_cv,
                .iterations = 22,
                .key =
                "\x10\xf9\x13\xdf\xae\xe7\xf1\x8e\xd5\x81\x6c\x01\x90\x11\xc5\x44"
                "\x4f\x18\x77\xcd\xae\x84\x4a\x75\xf8\xcc\x81\xca\x6e\x67\x18\xae"
                "\x7a\x2a\x5a\xaa\x6c\xd8\xa5\x7b\x26\x60\xbf\x3b\x8c\x02\xbb\xb1"
                "\x44\x1e\x90\xe0\x2d\x0a\x9d\x52\x41\xda\x0d\x7c\x09\xfc\x59\xb6"
                "\x5b\x33\x06\x84\x5a\x20\x5c\x20\x23\xef\xbe\xcf\x7f\xcf\x59\xbe"
                "\x8a\xd2\x74\xf2\x00\x12\x77\xf2\x2f\x8d\xf8\x74\x25\xbf\x49\xaa"
                "\x92\xa1\x45\x0b\x17\x5e\xeb\x6f\xbb\xd3\xb5\xe6\x23\x65\x3f\x62"
                "\x13\x23\xe1\xd6\x68\xdd\xa5\x9c\xd1\x8e\x2a\x23\x5c\x72\x58\xad"_cv
            },
        test_vector
            {
                .id = 6,
                .ikm =
                "\x85\x0f\x05\xc5\x34\x35\xe7\xa6\xb3\x3d\xa8\x20\xf7\xde\x66\xcc"
                "\x97\x2a\xb9\x03\x6b\x99\xf6\x04\xa1\x04\x50\x71\x51\xee\xab\x45"_cv,
                .salt =
                "\x6b\xb0\x01\xa2\x8f\x57\xd8\x05\x14\xb1\x0a\xe6\x73\x16\x71\xe5"
                "\x6d\x0f\x87\xd0\x5d\x03\x40\xef\x49\x08\x05\xa3\x7d\x39\x7f\xf3"_cv,
                .iterations = 23,
                .key =
                "\x9f\xc5\xcc\x61\xf3\xb1\x6d\x4d\xb0\x44\x4c\x26\x93\x3e\xec\x48"
                "\x4e\xa8\x16\xc6\x52\x6e\x69\x20\x35\xd1\xb7\x21\xfc\x59\x83\x56"
                "\xf8\x98\xb2\x41\x3d\x9d\xf8\xa7\x9b\x34\x80\x4f\x8f\x7c\xb0\x9f"
                "\x30\x40\xd4\xd3\xab\x92\x27\xd2\xfb\x0b\xa6\x5e\x62\xd3\x1d\x8a"
                "\xea\x12\x6c\x17\x7b\xbe\xf3\x2d\x8b\x14\x82\x46\xf9\xe5\x77\x81"
                "\x93\x1c\x96\x1c\xda\x5c\x77\xce\xf3\x56\x02\xa1\x75\xf5\x57\xca"
                "\xcf\x48\x9d\x5c\x90\x10\x91\x48\x79\xff\x6e\x46\xdc\x03\xcf\x65"
                "\x7c\xa4\x68\x14\x84\x63\x37\x4d\xb7\x9c\x4d\x40\x76\xd8\x55\x1c"_cv
            },
        test_vector
            {
                .id = 7,
                .ikm =
                "\x28\x2c\xd6\xf1\x4e\x53\x5b\xea\x2c\x14\xdc\xc6\xaa\x81\x01\x58"
                "\x97\x83\x82\x1e\xa2\x21\x08\xf5\x77\x32\xa7\x76\x18\x10\x86\x15"_cv,
                .salt =
                "\x65\x23\x33\xa6\x01\xdd\x0e\x2a\x9b\x47\xbd\x92\xaf\xc3\xb5\x6a"
                "\x54\xcf\xff\x7a\xa3\x91\x56\xc5\xbd\x4a\xdb\x84\x79\xc0\xe1\x88"_cv,
                .iterations = 24,
                .key =
                "\x45\xb9\xeb\xcd\xdc\x40\x83\xf9\xbc\x4d\x78\xec\x13\x61\x81\x97"
                "\x4d\xc6\xe9\x8f\xaa\x1a\x1a\x80\xf6\x27\xc0\x05\xaa\x9f\x53\x6a"
                "\x8a\xff\x02\x8a\xc3\x61\xb4\xb4\xe7\x83\x48\xc8\xad\x36\x8a\x93"
                "\xcf\x7c\x8d\x13\x90\xef\xe7\x9b\xad\xcf\x90\xc5\x9f\xce\x1d\xa4"
                "\x3c\x77\xb6\xdb\x53\xb0\xa8\x68\xf3\x49\x33\x61\x59\x13\x66\x56"
                "\xb8\x59\xd5\x5c\xc2\x9e\x75\x66\x60\xc3\xcc\x54\xd4\xc4\xf3\xc0"
                "\x10\xe1\xc4\xfa\x24\x2a\xcc\x72\x5a\x62\xff\x37\xb5\x8d\xab\xff"
                "\xfa\xfb\x93\xcb\xa3\x7a\xfd\xc9\x60\xb2\xa3\xea\xe3\x37\x71\x9e"_cv
            },
        test_vector
            {
                .id = 8,
                .ikm =
                "\xd2\xdd\x47\x79\xb9\xd8\x38\xc1\x97\x1c\x71\x8c\x5d\x22\x3c\x74"
                "\x08\x91\x66\x6c\xfe\x32\x76\xc1\x3b\xfe\x2a\xd3\xed\x9c\xfb\x04"_cv,
                .salt =
                "\xe7\x43\x6e\x63\x21\xbc\xee\x1e\x88\x9a\x44\x05\xcf\xcb\x3d\xd8"
                "\x06\xa7\x58\x65\x9b\xa7\x42\x00\xda\x58\x36\x62\x8d\x74\x26\x93"_cv,
                .iterations = 25,
                .key =
                "\xa0\xad\xd1\x6e\x79\x4b\xa4\xef\xf6\x45\x56\x36\x60\xde\x84\x30"
                "\xbb\x34\xa3\xb2\xc8\xa7\x7d\x16\x8b\x98\x4c\xaa\x38\x1e\xb3\x8b"
                "\xb5\x64\x17\x43\x14\x32\x65\xb4\x6f\xf6\xe5\x06\x20\x26\x01\x5a"
                "\x28\x96\xba\xcd\x14\x59\xb1\xbe\xa7\xc0\x90\x90\x50\x09\x05\x2d"
                "\x49\xfe\xec\x0d\xe3\xf6\x2f\xbe\x29\x8a\x8a\x76\xa2\xe1\x22\xa0"
                "\xe0\x1a\x75\x2b\x57\xe9\x7b\xec\x45\x09\x28\x65\xb5\xbe\xb4\x1b"
                "\x39\x01\xea\x89\xb3\x7e\xdb\x0d\xb7\xb5\xb4\xd9\x3d\xd8\xe5\xa0"
                "\x4c\x0b\x7f\xec\xf8\xe4\x99\x3f\x6a\xed\x19\x68\x30\xe2\xbd\x35"_cv
            },
        test_vector
            {
                .id = 9,
                .ikm =
                "\x91\x6f\x09\x39\x30\x8a\xda\x77\x5c\xc7\x8c\xb0\x23\x6d\x95\x8c"
                "\x55\xda\xb3\xcb\xab\x87\x8c\x3e\x4e\x00\x5a\xa3\x15\x31\xfc\xda"_cv,
                .salt =
                "\xfb\x70\xf0\x17\x96\xd0\x77\xa5\x98\xd9\xc9\xf4\x83\x70\x72\x85"
                "\xb4\xf5\xd8\xab\x7f\x3a\x36\xa7\x69\xec\xdc\x3c\xbb\x72\xc4\x4e"_cv,
                .iterations = 26,
                .key =
                "\x46\x12\xbe\x6e\xb6\xcc\x7c\xbd\x32\x82\xe7\x88\x96\x33\xa6\x70"
                "\x2d\x9d\xcd\x2a\xec\xd3\xa8\x76\x53\x21\x39\x21\x8c\x53\x95\xcf"
                "\x46\x48\x37\x13\xb4\xe5\x79\x5e\xbf\x47\x69\x7f\x5a\xff\xef\x48"
                "\xff\x52\xc7\x85\x9e\x06\x92\x1d\x0c\xb1\x29\xf3\x79\x19\x95\x09"
                "\xb4\x6d\xdc\x85\x10\x2d\x03\x48\x49\x62\x32\x0c\x72\x2e\x33\xab"
                "\xfe\xa9\xfe\xc9\x3a\x26\x68\x83\xc7\xde\x63\x31\xfd\x90\x9c\x55"
                "\x81\x14\x33\x95\x2d\x0e\x6f\x7e\x5d\xf8\x57\x52\xe4\xae\xd4\x73"
                "\xca\x0b\xec\xe6\xe1\x07\x96\x34\x7d\x35\x33\x0a\x30\xdd\x9e\xe9"_cv
            },
        test_vector
            {
                .id = 10,
                .ikm =
                "\x23\xed\x67\x34\xd8\x7c\xfd\xc3\xbd\x12\xad\xf1\x3f\x60\x4f\x72"
                "\xce\xa1\x91\x63\xb0\xce\x6c\xbb\x3a\x3f\xa3\x73\x99\x11\x37\x42"_cv,
                .salt =
                "\x65\x8e\x93\xed\xdd\x67\xc5\xf9\x51\x7e\xe2\x6a\xa0\x59\x57\x3d"
                "\xe2\x07\x0e\x5a\x5a\x83\x87\x02\x9d\xc4\xb7\x42\xa8\x8d\x49\x2e"_cv,
                .iterations = 27,
                .key =
                "\xae\x39\x18\xdf\x67\xb4\x41\x76\x6a\xc6\x79\x53\x3d\x6c\xda\x70"
                "\xf7\x85\x19\x08\x45\xbb\xe8\xb1\x95\xce\xe0\x02\x96\xcf\xd0\x7c"
                "\x63\xe9\xaf\xf6\xd6\xf3\x3e\x38\x10\x76\x4b\x5c\xee\xe8\xf9\x7d"
                "\xca\x4e\xe6\xf6\x57\x37\xb1\x37\xb9\xa0\xe7\xee\x42\x99\x7e\xb4"
                "\xb5\xbb\x92\xc4\x4d\xaa\x5b\xbb\x2b\x04\x35\x36\x59\xcd\x4e\x49"
                "\x7a\x9a\x8c\xfa\x46\x3d\x66\x04\x9a\x1e\xbe\xca\x99\x7d\x7d\xb9"
                "\x7b\xfa\xa4\xe0\xd7\xbb\x44\xfe\x8d\x31\xaa\x1f\x16\x99\x97\x99"
                "\x21\xdd\x0d\xbf\xd8\xd2\xea\xe5\x4c\x77\xa9\x3b\x91\x8f\x86\xf3"_cv
            },
        test_vector
            {
                .id = 11,
                .ikm =
                "\x4e\xab\x98\x26\x9e\xbc\x63\x90\x52\xd3\x11\xb1\x4c\x4f\x27\x54"
                "\xbe\xcb\xea\x24\x07\xba\xee\x77\xa9\x5f\x33\xf1\xe0\xba\x23\xe3"_cv,
                .salt =
                "\xf4\x40\x3c\xfc\x58\xc2\xc5\x0b\x8e\x6b\x43\x11\x35\xba\x44\xad"
                "\x73\x70\xd1\xd6\x32\xae\x75\x61\x1d\x46\x17\xbc\x8b\x79\x2a\xb1"_cv,
                .iterations = 28,
                .key =
                "\x22\x8d\x2e\x48\x3e\x81\x10\x26\xe1\xd6\xe9\x05\x1d\x48\xde\xe2"
                "\x19\x44\x12\x0d\x22\xc3\xc5\xfa\x43\xee\x92\x8b\x9b\xa9\xbd\x74"
                "\x84\xe6\x80\xb9\xb2\x28\x0c\xb6\x33\x31\xad\xda\x3d\x8e\x51\x49"
                "\xd3\x5f\xf9\x60\xf4\xc3\x2d\xbc\x0c\x4f\xa6\xc1\x50\x78\xd6\x6e"
                "\xa3\x79\x8c\x5d\x0c\x01\x2b\xc6\x2e\xf3\x8c\xc0\x8d\x5d\x60\x30"
                "\xef\x6b\x1f\x2d\x87\x64\xa3\x8a\x42\x53\x2e\x0b\x0f\xb0\x9b\xc5"
                "\x22\xcd\xb4\x95\xf5\x49\xfb\x5f\xd2\xff\x91\xa6\x88\x32\x4d\x41"
                "\xa6\xa5\x1d\xc9\x2a\x90\xf5\x2c\x91\x0f\x55\xb0\x42\x9c\x84\x4e"_cv
            },
        test_vector
            {
                .id = 12,
                .ikm =
                "\xfc\x98\x09\xed\xe3\xc0\xe5\xda\x03\x00\xb0\xa1\x70\xda\x05\x13"
                "\xa5\xc4\x5d\x5d\xfb\x10\x35\xf8\x9e\x7e\x1d\x58\xe7\x09\x99\x96"_cv,
                .salt =
                "\xee\xfb\x7b\x49\xbb\x42\xf1\x62\x5e\xa8\xd1\x2b\x75\x08\xcc\x2a"
                "\xb6\xe8\x2e\x45\x50\xab\x47\x53\x0e\x1d\x1f\x23\x67\x52\x58\xaa"_cv,
                .iterations = 29,
                .key =
                "\x3f\x0c\xf7\x9b\xcc\x25\xf4\x39\x76\xbf\x44\x90\xc6\x79\x58\xbb"
                "\xaf\xc4\xeb\xa7\xfa\x22\x9c\xc9\x92\xb3\xca\x87\x90\xf4\x14\xf3"
                "\x8a\x86\x86\x31\x4f\x67\xad\x3b\xb1\x95\xf2\xdf\x6d\x53\x15\x15"
                "\xa1\x9c\x3d\xfe\xff\x1c\x62\xed\x85\x13\xd6\xde\xc8\x2c\x78\x99"
                "\x76\x97\x90\x7d\x3e\x0c\x96\xea\x98\xbd\xee\xb4\xbc\x4b\xfa\x9b"
                "\x6d\xbd\xd7\x06\x2c\x69\x6d\x16\x5a\xa8\x66\xbb\x77\x54\x38\xa7"
                "\x6b\x12\x2a\xab\x9c\xcb\x02\x78\x1a\x0d\x70\xa5\xa9\xf6\x08\x35"
                "\x23\xe7\xeb\x6c\x0c\x4b\xfb\x8d\x15\xaa\x85\x45\x1f\x6a\xb4\xa0"_cv
            },
        test_vector
            {
                .id = 13,
                .ikm =
                "\xb6\x70\xda\x0b\x79\xaf\xc4\x71\x3b\x51\xf0\x8d\x8e\xbd\xd9\xec"
                "\x12\x2a\xc5\xee\xe3\x52\x1b\xb1\xba\x3c\x56\x4d\x97\x30\x39\xef"
                "\x17\xe5\x6c\xe6\xe6\xde\x8e\xbe\x67\xbf\xeb\x2e\xc7\xc8\x02\xa3"
                "\xf2\x8c\x4b\x1c\xa0\xbe\x06\xf6\x67\x9b\x30\x0a\x36\x58\xe9\x98"_cv,
                .salt =
                "\x85\xd0\xc1\x9c\x4f\x65\xa1\xb2\x04\x74\x3b\xef\xe5\xc7\xa4\x6b"
                "\xa8\x62\x3d\xe6\xce\x98\x8e\x42\xe2\xf3\xd5\x75\x65\x91\x0f\xaf"
                "\xb2\xd8\xf0\x1f\x57\xa1\xdf\x70\xd9\x0c\x79\xad\x73\x5d\xc6\xd9"
                "\xae\x61\x2d\x28\x3c\x37\xde\xf9\xe5\x5f\x42\x67\x86\x59\x34\x7c"_cv,
                .iterations = 20,
                .key =
                "\x95\x2f\xd7\x75\xa6\xf7\xdb\xf1\x78\x1f\xdc\x7b\x0d\x30\xc1\x9d"
                "\x3f\xf3\xa6\x9b\x5d\xe3\xb2\x58\x94\x06\x9d\x0a\x78\x93\x7d\x60"
                "\x72\xb2\x68\xcc\x0e\x16\x95\x3f\x2d\x68\x85\xe4\x0a\xf7\x16\x66"
                "\x5d\xfa\xd5\x87\x37\x3b\xbb\xe9\x62\x4f\x9e\x92\x34\xab\x45\xba"
                "\x90\xda\x8a\xe2\x66\x68\x9b\xb2\x10\x02\x52\x38\xb4\x41\xc0\xa3"
                "\x6e\x51\xee\x12\xb3\xc0\x40\x7d\xf5\x8b\x87\x7c\xe1\x8b\x4f\xea"
                "\x1b\xb2\xe9\x26\xba\xe1\x8c\x8b\x05\x24\x4d\xe3\x06\x3e\x4c\x1e"
                "\xcb\xaa\x14\x06\xff\xbe\x54\xac\x73\x3b\x7e\x63\xf3\x07\x22\xa7"_cv
            },
        test_vector
            {
                .id = 14,
                .ikm =
                "\x6a\x1d\x9c\xb7\x34\x10\x80\x10\x6d\x86\xfd\x93\xc3\xd7\x5c\x38"
                "\x68\xcb\xa1\xc5\xfc\x66\x13\x41\x54\x2f\xa0\xbf\xdd\xe7\x8d\x7e"
                "\xeb\x2d\x39\x91\x30\xdb\xa2\x27\xf1\x8a\x86\x20\x47\x50\xd7\x38"
                "\xbb\x71\x44\xc5\xcf\x3c\xe6\x18\x02\xde\xec\x59\x29\x55\x77\xcc"_cv,
                .salt =
                "\xd3\xb2\x6d\xa5\x43\x81\x41\x22\x81\xdf\x1c\x75\xda\xad\x2c\xa7"
                "\xec\x7d\xe7\x20\x34\x7f\x43\x7d\x8d\xb2\xcf\x95\xe2\xc2\x33\x97"
                "\x20\xf1\xe0\x01\x5e\xb8\x5f\xc9\x4a\x91\xa3\x73\x45\x04\xd8\x2d"
                "\xa1\x5c\xfb\xaf\x46\x56\x0d\xe1\x1f\xc8\xe3\x3b\x08\x0a\xd6\x1a"_cv,
                .iterations = 21,
                .key =
                "\x8c\x26\x5b\x1f\x08\x80\xf9\x4c\x80\xdb\x04\x79\x99\xa0\xec\xd9"
                "\x3f\x4d\xd0\x29\x82\x1e\x0c\x3a\xf6\xdd\x60\x37\x05\x0b\x24\x28"
                "\x52\xa5\xcd\x6e\x83\x8c\x25\x64\x32\x27\x30\x84\x5e\xe3\x06\x29"
                "\x48\x66\xb9\xc3\xc6\x4f\x63\x80\xbc\xda\x49\x94\x96\xf3\x34\xb3"
                "\xd3\x61\x9b\xad\x8b\x37\xa9\xd9\x40\x72\xe2\x82\x21\x4d\x76\x6f"
                "\x01\x84\x1f\x07\x2b\x8b\xf9\xcb\x72\x35\x6b\x4a\xca\x8d\xfa\xe5"
                "\x9b\x1e\x1f\x5d\x1a\xd3\xdb\x78\xf6\xac\x7d\xab\x47\xfe\x32\xf3"
                "\xb5\xc0\xc4\x46\x02\x2c\xa6\x76\x02\x2e\x8e\xde\x49\x94\x79\x79"_cv
            },
        test_vector
            {
                .id = 15,
                .ikm =
                "\xc2\xb5\xc6\x0e\xda\x51\x3a\x9a\xa3\x69\xf3\xdc\xe9\x0f\x11\x8b"
                "\xc0\xae\x01\xf7\xef\x35\x0c\x46\x05\x4f\x99\x7d\xb5\xf3\x8b\x5f"
                "\x80\xbc\x26\x47\x85\xc3\x96\x0c\xf9\xdb\x11\x76\x5f\xf3\xf5\x84"
                "\x62\x65\xb4\xa0\x43\xe2\xec\xef\xbd\xe2\x7b\x3b\x7f\x51\x53\x4c"_cv,
                .salt =
                "\xee\x74\x66\xc8\xa9\x89\xb2\x5b\xda\x07\xb8\x67\xb1\xa9\xac\x41"
                "\x88\x8e\x90\x54\x41\x96\x1d\x9b\x4a\xc0\x52\x0b\x06\x20\xc0\xc1"
                "\x66\x9b\x8d\xb1\x38\x7d\xa6\x50\x1c\x1f\xa4\xbf\xab\x3a\xb9\x28"
                "\x9f\x05\x54\x0e\x7e\xf6\x08\xf8\x9e\xc9\x63\x49\xe2\x07\x46\x53"_cv,
                .iterations = 22,
                .key =
                "\xd9\x68\x75\xdb\xd1\x1e\x94\x73\xe6\x4f\xa6\x92\x11\x65\xbb\xf3"
                "\x6a\xcc\xa5\x12\xd8\x67\x5d\x47\xc2\xe9\x1d\x5b\x37\x0d\x6a\xe2"
                "\xad\xd1\xab\x16\xd3\xe3\xba\xc8\xcd\xc3\x2b\x5c\xe2\x3c\x6e\x1d"
                "\xa2\xb2\xdb\x08\x3a\x73\x14\xb0\xd0\x20\x46\x98\x75\x2a\x02\x1a"
                "\xa7\x08\x42\x21\x1e\xb8\x11\xb3\x45\x55\x0f\xc8\x06\x5e\xd9\xab"
                "\x26\x3f\x3a\x9d\xe2\xfb\xbb\x57\x28\x21\x47\x91\x56\xd8\xfd\xd4"
                "\xcd\xeb\x6e\x7c\x3e\x82\x1c\x56\x4b\x27\x8b\x23\x80\x96\x24\x58"
                "\x1a\x99\xdb\x05\x09\xc8\xb8\x31\x16\x1d\xa7\x35\x3d\x36\x96\x41"_cv
            },
        test_vector
            {
                .id = 16,
                .ikm =
                "\x09\xf5\x6d\x71\xd4\xcf\x64\xb5\x73\x19\xa5\xb7\xd9\x4d\x29\x70"
                "\x6b\x6a\x6c\x42\x4f\x82\x3d\xaf\x9d\xc5\x22\x02\xaa\x0c\x1a\x4b"
                "\xcc\xb2\xae\xa4\x9e\x66\xe4\x21\x4e\x5d\xf2\x79\x6c\x1c\x2e\x0b"
                "\xb2\xd2\x8f\x75\x12\x84\x6b\x37\x74\xc1\xef\x65\x27\x93\x2f\xbd"_cv,
                .salt =
                "\x3f\x53\x53\xcf\xa0\x88\xde\x60\xa3\x2b\x89\xde\x92\xa3\x24\xee"
                "\x11\xd4\x5a\x3b\x23\xfc\x32\x36\xbb\x16\x7d\xa8\xed\xa7\xbf\x5b"
                "\x4e\x74\x1c\xf0\xba\xcf\x2b\x5b\x80\x4d\x8a\xb6\x67\xbd\xbe\x65"
                "\x25\xb4\x01\x2d\x78\x4e\x06\x94\xbd\x0b\x21\xdb\x4a\xa2\x61\x22"_cv,
                .iterations = 23,
                .key =
                "\xd0\x68\x3b\x3f\xdd\xf6\xc8\xa6\x60\x36\x21\x51\x49\x29\x53\xe4"
                "\x18\x96\xc6\x59\x77\x6a\x5b\x6e\xae\x4b\x0c\x27\x4d\x1f\xd3\x62"
                "\x31\x48\x4c\xc8\x90\x8b\x65\x1d\x8a\x47\xc4\xbb\x7e\xdd\xc1\xd3"
                "\xb9\x1e\xce\x56\xe1\xbd\x3a\xf5\x5f\xda\x32\xdb\x25\xc3\xa4\x98"
                "\x8b\xfc\x4b\x66\x09\x32\x61\x6d\x29\x23\x41\x11\x9d\x28\x24\x70"
                "\x29\x93\xc0\x59\xb6\x14\xe8\xae\x62\x37\xdc\x27\x2f\xdb\xd0\x0c"
                "\x28\x0d\xac\x17\x33\x0a\xf6\x29\x57\x21\x55\xdd\x2c\x73\x80\x67"
                "\x4c\xc3\x69\x54\xa2\xaf\x09\xd2\xb5\x98\x72\x7b\x18\x3d\xa8\x9b"_cv
            },
        test_vector
            {
                .id = 17,
                .ikm =
                "\x15\x2c\xe7\xd6\x1a\x45\x21\x67\x68\x85\x44\x8f\x78\x11\x7a\xe4"
                "\x94\x96\x92\xf6\xfd\x1d\x0e\x16\x93\xc8\x63\x18\xe0\x70\x88\x14"
                "\x2a\xdf\xaa\x9b\xd8\x3c\x8b\xee\x5e\x9f\x50\x9c\x6d\x8b\x9b\x6b"
                "\xf1\x4e\x32\x6e\x34\x9a\x8b\xbd\x99\x17\x9b\x51\xa5\x62\xc6\x40"_cv,
                .salt =
                "\x0d\xa7\x7a\x8a\xce\xd5\x2a\x09\x46\x68\x58\x60\x5c\xb0\xfe\xd1"
                "\x86\xba\xc8\x8b\xc6\xaf\xbb\x1f\xd2\xf7\xb2\x8c\xc9\x66\x25\xa3"
                "\x25\xe4\x77\xd9\x07\x34\x13\xb5\x92\x97\xaf\x5a\xe2\x0e\xab\x3b"
                "\xa8\x20\x57\xfb\x31\xf1\xba\xb1\xf8\xce\xe7\x8f\xa6\xaa\x55\xee"_cv,
                .iterations = 24,
                .key =
                "\x6b\xcc\x8f\x79\xe6\x03\x1e\x0e\x84\x9c\x98\x04\x2f\x35\x42\x73"
                "\x11\x4b\xbe\xb5\x20\x7d\x98\xa9\x57\x2a\x71\x48\xb4\xa5\xe4\xfc"
                "\xba\x86\x35\xba\x21\x27\xbb\x02\x93\x9c\xc9\xdb\x51\x0e\x52\x82"
                "\x4c\x08\xb2\xd5\x67\x37\x8f\x3a\xe3\x5d\xf8\x19\x0f\x70\x39\x6b"
                "\x54\xe0\xdd\x20\x0e\x4b\x4d\xa3\xef\xa4\x14\xc2\x25\x99\x2a\x08"
                "\x85\xc2\x82\xf3\x46\xe1\x6d\x2f\xbc\x4d\x26\x8e\xda\x1b\x4c\x4b"
                "\xb0\xed\xfd\xbc\x09\xd1\xd1\x6e\xb0\x5b\xeb\x8c\xdc\x9e\x6c\xc8"
                "\x65\x9d\xb7\xbe\xa7\xd4\x97\x70\xbb\xb1\xee\x98\xdf\x16\x3d\x0c"_cv
            },
        test_vector
            {
                .id = 18,
                .ikm =
                "\xc6\xab\xa9\x3e\xe6\x3e\x77\x21\x2b\xb9\x27\x2e\xbe\xdb\x9d\x2f"
                "\xb7\xe6\xbf\x12\xe9\x8d\xb0\x28\xf7\xc2\xea\x52\xd0\x76\x61\x77"
                "\xf0\x9d\xa3\x71\x39\x17\x36\x13\xec\xa7\x9d\x75\x16\xe9\x8c\x04"
                "\xb3\x28\x41\x70\xe9\xe2\xde\x4c\xe4\x66\xbc\x8b\xe1\x6c\x6f\x1e"_cv,
                .salt =
                "\xd8\x4a\x39\x59\xbc\xf1\xa8\xbd\x0f\xe4\x5c\xc0\xcb\xda\xfe\x34"
                "\xc5\xc0\x6f\x0a\x4c\x02\x1a\x59\xc3\xea\xf7\xf4\x38\xf7\x25\x58"
                "\x41\xa4\xbb\x7c\x08\xd6\xee\x56\xf5\x9d\xa1\x50\xf1\x12\x16\x08"
                "\x0a\x7c\xb0\x1c\x51\x4e\xf6\x22\x78\x90\x71\x58\x0d\x59\x4a\x8b"_cv,
                .iterations = 25,
                .key =
                "\x3f\x5d\xc4\xd3\xa5\xcb\xa4\x49\xa4\x03\xe5\xf8\xad\xee\x01\x5e"
                "\x6b\x01\xa6\x32\xda\xa5\xc1\xdc\xd9\xf6\xaa\x16\xb6\xfa\x7b\xc2"
                "\x22\x8b\xf9\x30\xa5\x8a\xe8\xe0\xfd\x08\xc0\x6b\x5d\x8d\x83\xab"
                "\xcc\xed\xac\x63\xb1\x09\x33\x49\xd3\x0c\x8d\xb0\x1c\x95\xc9\x96"
                "\xee\x0f\xa7\xa6\xaf\x0c\x0c\x4e\xf4\x1f\xac\x7a\x15\x29\x33\x93"
                "\x05\x23\xb8\x1a\x2f\xe0\xdc\x51\x84\xed\x77\xb4\xc3\x01\x15\xd9"
                "\xd9\xa4\x80\xf3\xa3\x2e\x58\x42\xdb\x9f\xef\x61\xb3\xc6\xb2\x5a"
                "\xcb\x53\xde\x28\x44\xf2\x1c\x84\x36\xea\x49\x6a\xf4\xf9\x06\x8c"_cv
            },
        test_vector
            {
                .id = 19,
                .ikm =
                "\xfe\xf6\xdc\x3f\x00\x35\x9e\x24\xaa\xa2\xdb\x79\x36\x49\x2d\x37"
                "\x82\xb0\xc9\x83\xe1\x2d\x57\x3f\x1c\xd5\xe1\x45\xe3\x1c\x66\xff"
                "\xf6\xfc\x4b\x9f\xe2\x26\x7d\x21\x43\xb4\x5b\xec\xcc\xa5\x4a\x00"
                "\xeb\x37\x57\xfd\x22\xf2\xd0\x65\x8a\x7b\xe5\x2b\x64\xe1\xe4\xdd"_cv,
                .salt =
                "\x94\x71\xee\x9f\x6e\x52\xa0\x39\xb5\x1d\x11\x0b\x82\xda\xb7\x31"
                "\xec\x5b\xe4\x3e\x0e\x3d\xf1\xf7\x15\xfa\xfa\x6c\x29\x60\xb6\xf7"
                "\xfd\xe7\xc8\xf9\x69\x93\x87\x1b\x87\x98\x6c\xa2\x51\x4c\xd9\xec"
                "\xc4\x8c\x1a\x61\xac\x9f\xea\xa6\xa5\xa6\xfc\xcf\x69\x86\xcc\x9a"_cv,
                .iterations = 26,
                .key =
                "\xad\x8d\x57\x5d\x76\xf5\x07\xb1\x58\x0d\x10\xac\x08\xc4\x92\x08"
                "\x66\x3e\x62\xaf\x36\xe8\x75\x8d\x57\xe0\xe0\x8c\xf7\x49\x22\x66"
                "\x2b\x82\xca\xc0\x8f\x08\x71\xd3\xfe\xe5\x3d\x98\x08\xe2\xab\xc6"
                "\x5a\x9c\x38\x4b\x11\x6d\xed\x2d\x8a\x0a\x2f\xa2\xeb\xde\xfb\x38"
                "\xbe\xf1\x1d\x36\x1d\x82\xc1\xfd\xeb\x48\xc1\x5c\x71\x78\x36\x8d"
                "\x5e\xb3\xff\xc5\x9f\xae\x33\xf5\x98\x8d\xa6\xbd\xbd\x21\xfe\x5c"
                "\xa2\x4a\xe8\x73\x98\x98\xd7\xf8\x91\x31\x43\xc9\xfa\xaf\x3a\x5a"
                "\x03\xe6\x4e\xd4\x9a\xdc\xba\x12\x6e\xbf\x44\xec\xf4\x01\x2d\xd3"_cv
            },
        test_vector
            {
                .id = 20,
                .ikm =
                "\x3d\x43\xf7\x62\x0f\xb8\xc3\xcf\xcd\x5f\xd1\x87\xa5\x73\xb1\xfe"
                "\x5a\x2b\x03\x77\x7a\xd0\x99\x42\x5a\x1b\x5c\xf4\x79\x25\x43\x39"
                "\x46\xf3\x57\x79\x48\x27\x20\x1d\xae\x48\x35\x46\x45\x76\x23\xad"
                "\x62\x42\xe5\x8d\x3d\x04\x27\xc3\xce\xd4\x82\xc8\x18\x19\xbf\x9c"_cv,
                .salt =
                "\x81\xa2\x2d\xb8\xfb\x87\x8a\xb4\x93\x9c\x84\x82\xac\x6b\x0d\xa0"
                "\x8d\x49\x44\x80\xca\xe3\x01\x4b\x92\xe8\xee\x80\x2a\x03\x89\xa0"
                "\x41\xa8\xb3\x9e\x8a\xdc\xed\x6f\xac\xea\x5a\x9f\x89\x8e\xdd\x14"
                "\x87\xf8\xc2\x8b\xc6\xa4\x35\x24\x6f\xda\x74\xbd\xdb\xc2\xb9\x14"_cv,
                .iterations = 27,
                .key =
                "\xf2\xd0\x65\x5f\x76\xeb\xe0\x94\x60\xca\x1f\x1d\xa1\x68\xfc\x0d"
                "\x08\xc1\x54\xdf\xce\x95\x70\x25\xc9\x46\x6d\xeb\xd1\x46\xc5\xe3"
                "\x67\xcf\x85\x90\x4e\xa5\x8c\x83\x16\x75\xe3\x16\x98\xd9\x95\xc7"
                "\xba\xbf\x7f\x77\x90\x07\x37\x0c\x15\xcd\xe1\x5e\xcf\xf5\xcd\x4d"
                "\x08\x55\x52\x2b\x35\x18\x30\xcb\x54\x50\x91\x3c\xe7\x96\xa5\x63"
                "\x11\x62\xca\x4d\x8c\xc3\x09\xc9\x66\x80\x75\x6a\x0c\xa9\xbf\x08"
                "\xa0\x7e\xb7\x0d\x8e\xcf\x0a\x8f\xd6\x17\xab\x4c\x04\x51\x54\x3e"
                "\x4c\x3b\xb2\x7a\xbf\xa3\x0c\xee\xe9\x5a\x44\xeb\xd0\x34\x8d\xf4"_cv
            },
        test_vector
            {
                .id = 21,
                .ikm =
                "\x49\x4c\x66\x2a\x0c\x31\xea\x36\xa5\x5a\x98\x79\x97\xa2\x30\x8d"
                "\x57\x01\x91\xbe\x8c\xaa\x9f\x84\x72\x0b\x3d\xb8\xb3\x33\x6a\xfd"
                "\xbb\xf5\xd6\x4d\xf4\xb2\x48\xe5\x2f\x37\x20\x8b\xb3\x7e\x2f\xba"
                "\x5b\x13\x0f\xf9\xba\xa3\xe7\x18\xc7\x3f\x6d\x2f\x8e\x5d\xf7\x7d"_cv,
                .salt =
                "\x66\x26\x30\xe1\x30\x82\xdb\x71\x9f\xe8\x1c\xd5\x1f\x03\x0e\xb4"
                "\xb2\x73\x7e\xfb\x74\x08\x2f\xac\x77\x06\x4a\x7e\x2a\xf6\xbd\x86"
                "\xd4\x55\xfb\x5a\x1c\x0a\x59\xfb\xd5\x5e\xc2\x32\x96\x90\xda\x5a"
                "\xcf\x08\x1b\x12\xea\xec\x1d\x26\x2a\x82\xf4\xc0\x56\xd1\xd7\x2f"_cv,
                .iterations = 28,
                .key =
                "\x3e\x80\xdc\xe3\x9e\x1a\x65\xd3\x12\x3f\xe7\x9e\x9a\x89\xbd\x7d"
                "\x95\x15\x3b\x95\x86\x09\x90\x8a\xb7\x1c\x22\xbd\x0a\x39\xe5\xb0"
                "\x59\x41\x9a\x12\x42\xab\x55\x8e\x8f\x47\xbb\x57\x1d\x32\x2f\x68"
                "\x73\x69\x9c\xe6\x60\xbc\xdf\x0d\x8e\xcd\x19\x1f\xe1\xd8\x16\xb5"
                "\x96\xd7\x0f\x3d\x4c\x59\x51\x8a\x83\x88\x09\xf6\x02\x54\x63\x6e"
                "\xff\xf0\x5e\xf1\x06\x51\xd8\x52\xca\xe3\x53\xc0\xc3\xeb\xe9\x05"
                "\x33\x3c\x29\xf9\xc0\x39\x40\x48\x9e\xc2\x13\x1e\x63\x1c\x7d\x84"
                "\x77\xc0\x5e\x84\xc2\xb3\xb1\x1e\x33\xd1\x96\x67\x0b\x7b\x4c\x33"_cv
            },
        test_vector
            {
                .id = 22,
                .ikm =
                "\xc5\x3f\xda\xfb\x16\x94\x70\x9c\xb7\xfb\x85\xfe\x7b\xe5\x00\x0b"
                "\x7e\x19\x66\x81\x5a\x31\x3b\x63\x0a\x5a\xb8\xd0\x7c\x76\xcc\x43"
                "\xf8\xaa\x0f\xd8\x48\x14\x98\xce\xc0\xad\xfd\xa3\x71\xde\x9d\x30"
                "\xee\xa2\x6d\x9f\xb5\x97\x65\x24\xfe\xfd\x39\x7b\x6b\x10\xdd\xb8"_cv,
                .salt =
                "\x4c\x7c\xcb\x06\x40\x43\x64\x33\x68\x7a\x1d\xb2\xff\x71\x86\xd1"
                "\x51\x30\xfc\xcc\x4a\x43\x88\x7a\xf3\x50\x75\x5d\x97\x0b\xa0\x96"
                "\x2e\x22\x8e\x49\x06\x2b\x0f\x01\xf9\x4c\x90\xe3\xcb\xf5\xd5\x65"
                "\xa6\x62\x3d\x53\xb6\x37\xca\xf0\x0a\xf3\x61\x06\xab\x83\xab\x33"_cv,
                .iterations = 29,
                .key =
                "\x19\x63\xe0\xda\x63\x69\x45\x8d\x6b\x5d\x72\x68\x4b\xab\x8d\xde"
                "\x84\xca\xb8\x3b\xd7\x82\x00\xf8\xdf\x29\x14\x94\x93\x79\x86\xf3"
                "\x1b\xee\x9d\xc3\xf8\x7d\x2c\xa5\x45\xb6\xc7\xc3\x93\x2e\x26\x47"
                "\x75\x61\xfb\x98\x10\xa9\xea\xf0\xc2\x10\x94\x9c\x20\x51\xd3\x66"
                "\xee\xd6\xce\x87\xc7\x5b\x39\x4f\x46\x47\x35\xfe\x2c\xb4\x92\x97"
                "\x61\xfa\xa0\xf6\x09\xfe\xfe\x04\xbd\x5f\x73\x83\x78\x0e\xcd\x35"
                "\x83\xfc\x4d\x9e\x37\x9b\x7d\xb0\xd9\x75\xd9\x52\xd2\xa3\x34\x06"
                "\xb0\x02\x45\x0d\x9b\x5f\x64\x44\x61\x83\x5d\x2c\xc1\xb5\x08\x69"_cv
            },
        test_vector
            {
                .id = 23,
                .ikm =
                "\x7c\x23\xc5\xb8\xd1\x28\x19\xc3\x5b\x4b\xd0\x78\x18\x7a\x19\x47"
                "\x87\x50\x97\xc1\x46\xc7\x0c\x33\xa1\x04\x23\xaa\x46\x77\xac\x09"_cv,
                .salt =
                "\xf1\x01\xf4\x45\x25\x9e\xe2\xc1\x84\x2a\xbb\xb5\x95\xf2\xa5\x5c"
                "\x13\x3b\x4f\x32\xce\xf4\xbe\xbd\xf5\x0e\x00\xa3\x7d\x4b\x65\xd4"_cv,
                .iterations = 10,
                .key =
                "\x0f\xce\x19\x86\x11\xd7\x2e\x7b\x25\x2f\x71\x4b\xe5\x01\x66\xea"
                "\xab\xc9\xe9\xb8\x92\x14\xe1\xc5\xbf\x4f\xfa\x91\x21\x12\x49\x9e"_cv
            },
        test_vector
            {
                .id = 24,
                .ikm =
                "\xd9\xf3\x24\x6f\xd9\x19\xbe\xfa\x93\x2f\xe3\x80\xc3\x9a\x08\x4a"
                "\xbc\x08\x51\x88\x16\x71\x76\xe9\x04\xc4\xfb\xc4\x62\x70\x9a\x25"
                "\x59"_cv,
                .salt =
                "\x2f\x41\xd2\x06\x23\x6e\x4c\x5e\x89\xb2\x89\xee\x70\x17\x95\x18"
                "\x01\xdc\xb3\x84\x35\x39\x1c\x68\x1d\x88\x7e\x46\x91\x70\xe8\x16"
                "\x94"_cv,
                .iterations = 10,
                .key =
                "\xd9\x4d\x11\x1a\x95\xc1\x87\xf4\xc2\x50\x91\xad\xf7\x80\xf4\x96"
                "\xb3\x26\xce\x69\xe8\x62\xdc\xf4\x7f\x78\xd1\x7c\xf9\xa8\x20\xb6"
                "\xaa"_cv
            },
        test_vector
            {
                .id = 25,
                .ikm =
                "\xdb\x8b\xd3\x94\x00\x9b\xbb\x47\x04\x58\x7e\x86\x9e\x37\x81\x32"
                "\x13\xc6\x32\x15\xa3\x39\x2e\x5c\x63\xff\x2c\x1a\xe0\x83\xfc\xaf"
                "\x0f\xac"_cv,
                .salt =
                "\x1c\x1d\xe0\xd2\x21\xb6\x51\xa2\x91\xcb\x55\xe6\x67\x9d\xc9\x96"
                "\xf1\x44\xda\x32\xfd\xdb\xc3\x86\xb9\x27\xf0\xb9\x72\x08\x01\x14"
                "\x47\xe6"_cv,
                .iterations = 10,
                .key =
                "\x5f\x55\xcd\x22\x7a\xea\xa5\x24\xdb\x27\xb8\x05\x9d\x34\x82\x53"
                "\x10\x84\xe4\x4b\x69\x55\xd5\x92\x97\xf1\xa9\x3e\xcf\xff\xe8\x48"
                "\xa0\xe1"_cv
            },
        test_vector
            {
                .id = 26,
                .ikm =
                "\x14\xb5\xeb\x85\x8a\x3a\x6f\x47\x4d\x8a\xab\x3c\x33\x12\x78\xb4"
                "\xfe\x69\x13\x41\x99\xee\x02\xf9\x0a\x69\x04\x46\xde\xc7\x8d\xa7"
                "\xe6\x6a\x27"_cv,
                .salt =
                "\x55\x0e\x3d\x79\x80\x90\xe3\x5c\x83\x58\x22\xb8\xf9\x6b\x10\xf2"
                "\x63\x0a\x1f\x03\x57\x46\x69\x01\xfa\xb0\x7a\xf8\x6c\x75\xf7\x71"
                "\x29\xdd\x17"_cv,
                .iterations = 10,
                .key =
                "\x26\x32\xb0\x08\x0c\x51\xcd\x6d\x3c\xeb\x46\x69\x1b\x24\x37\xb9"
                "\x76\x1b\x7e\xda\x52\xff\xd1\x89\x4a\xdc\xb3\xf6\xea\x1e\xe7\xbb"
                "\xf8\x31\xdb"_cv
            },
        test_vector
            {
                .id = 27,
                .ikm =
                "\x1f\xb5\x33\x81\x2f\x4b\x0b\x5a\x50\x7e\x00\x7f\x0a\xa0\x01\x46"
                "\xa7\xbd\xbf\xa8\x3e\x9a\x49\x03\xf1\x38\x3a\x48\x42\xe0\xae\x00"
                "\x2e\xa6\xd1\x5e"_cv,
                .salt =
                "\x2f\xe8\xb8\x27\x85\xc3\x52\xb4\x4d\x6f\x21\xbc\xc9\x6e\x02\x3c"
                "\xc6\x93\x15\x3e\xa2\x7a\xd7\x99\x02\x52\x91\xf3\x30\xd3\x18\x5f"
                "\xec\xf0\xf5\x15"_cv,
                .iterations = 10,
                .key =
                "\xba\x6a\x12\xb9\x98\xd8\x49\x6a\xc4\xb4\xb7\xba\x7e\xc2\xbb\x3d"
                "\xc6\x3d\x9f\x75\xd7\x15\x0e\x69\x8e\xc4\x6d\xa2\xc3\x9b\xb2\xe5"
                "\xde\xf1\xfa\x2d"_cv
            },
        test_vector
            {
                .id = 28,
                .ikm =
                "\xe4\xb3\x67\x07\x27\x43\xf1\x73\x18\xbe\xf3\xce\x6c\xbd\x45\xf4"
                "\x91\x7c\xa2\xa9\xa0\x1f\x4b\x64\xc8\x1c\xd0\xeb\x60\xd6\x0c\x19"
                "\x41\xd5\x64\xdf\xf9"_cv,
                .salt =
                "\x21\x96\x68\x63\x4a\x4f\x21\x41\xe8\x95\x32\xa1\xb3\xb0\xe4\xd4"
                "\xaf\xb0\x69\xa3\x98\x6c\x62\x80\x88\xc3\x0a\xe0\x00\xbb\x2c\x61"
                "\xd3\x21\xbe\xba\x3d"_cv,
                .iterations = 10,
                .key =
                "\x1e\x44\x17\xbb\x6f\x3e\x6f\x59\x37\x39\x38\x52\x3b\xf7\xf1\x4a"
                "\x87\x0b\x85\xb8\x57\xa2\x8d\xee\x8c\xbd\x77\x9c\x50\xfc\x54\xd6"
                "\x38\x65\x7a\x9f\x79"_cv
            },
        test_vector
            {
                .id = 29,
                .ikm =
                "\xf4\x66\x14\x42\x59\x1d\x66\x89\x89\xd5\xb6\x71\x3a\xcc\xc9\x94"
                "\xe2\xd8\xf8\xf0\x9d\x4a\xff\xb8\xf7\x4d\x08\xdd\xf7\xb3\xb8\x4d"
                "\xae\x18\x40\x28\xee\x98"_cv,
                .salt =
                "\x51\x6c\x00\x85\xb4\xb2\x55\xed\x2c\xe4\x04\xf8\x48\x64\x50\x3b"
                "\xb8\xa9\x71\x90\xdd\x59\x8d\x39\xb6\xbd\x33\xcc\x0d\xbd\x57\x79"
                "\x0b\x51\xcc\x11\x57\xe9"_cv,
                .iterations = 10,
                .key =
                "\x3d\x69\x27\xe2\x50\x1c\x16\x83\xd2\xf4\xdd\x2d\xc5\xa0\xf2\x26"
                "\x85\xb0\xac\x9b\x47\x0b\x0b\x41\x5d\x43\x9b\x2f\x53\xa6\x28\x2f"
                "\x9c\xd8\xfb\xf9\xc2\xb5"_cv
            },
        test_vector
            {
                .id = 30,
                .ikm =
                "\x81\x14\x49\x9d\xd5\x61\x1e\xe3\x12\x8e\xbc\x77\xa2\xcf\xa8\x8e"
                "\xdf\xf3\x64\x0e\xa7\x6d\x9b\x99\x23\x28\x49\xbe\x07\xa5\x76\xdd"
                "\x0a\x92\x57\x47\x83\xfd\x44"_cv,
                .salt =
                "\x11\x07\x7d\xcc\x6b\x05\x28\xe3\x97\x41\x21\x02\xe4\x56\xad\x81"
                "\x9c\xf3\x98\x15\xb3\x6e\x3c\x83\x97\x3c\xbe\xe7\x8e\x44\x63\x8d"
                "\xe3\x24\x44\x57\x9e\xe2\x8c"_cv,
                .iterations = 10,
                .key =
                "\xda\x0e\x76\x96\x9d\x58\x71\xc9\x96\xf7\xa3\x3d\xe7\x29\x6c\x90"
                "\x93\x10\xdc\xfa\x75\x81\xa7\xc2\x2b\x3d\x20\x83\x7d\x54\x24\x2a"
                "\xe2\x65\xc8\x54\x0b\x10\x7b"_cv
            },
        test_vector
            {
                .id = 31,
                .ikm =
                "\x9b\xaf\xf9\xa1\x36\x4b\xb8\xda\x41\xda\xbe\x4d\xc2\x0c\x5f\x2e"
                "\xe1\x6a\x21\x81\xab\x8b\x1b\xb2\x3b\xdc\x52\xd1\x20\x98\xfd\x90"
                "\xef\xe6\x5e\xcf\x1a\xa6\x7e\x7f"_cv,
                .salt =
                "\xba\x84\x0c\xfd\x5b\xe2\x16\x99\xd2\x21\x13\x27\xb5\x98\xe3\x6a"
                "\x9d\xa9\x62\x0a\x39\xc5\x50\xc0\x47\xd8\x66\x06\x40\xae\xfd\xe1"
                "\x25\x2d\x73\x79\xbb\xf4\x08\xf3"_cv,
                .iterations = 10,
                .key =
                "\x5c\x62\x8a\x97\x7b\x68\x84\x90\x0d\x46\x00\x2b\x6b\xb0\x0c\x9d"
                "\x46\xdd\xaa\x98\xb9\x23\x2e\x99\x3a\x6c\x08\xec\x34\x4e\xae\x0e"
                "\xc9\xb3\xf9\x7d\x30\x4a\x39\x3b"_cv
            },
        test_vector
            {
                .id = 32,
                .ikm =
                "\x8e\x3d\x2f\xbf\xfc\x90\x28\x94\x4d\x90\x65\xbb\x7a\x83\x6e\x37"
                "\xa5\x08\x7e\xe6\xd6\x74\x97\x1f\xc4\x5d\xa6\x8b\x1c\x19\xb2\x49"
                "\x32\xa6\x8c\x50\x50\xe1\xd2\xcb\x42"_cv,
                .salt =
                "\xa9\x4b\xaf\xb3\x7a\x7e\xa7\x51\x20\xc2\x20\x3c\x9c\x7a\x1d\xd0"
                "\xe9\xd7\x59\x9f\xd7\x27\x97\x67\xc3\x90\xab\x6f\x59\x1a\x67\xc8"
                "\x1e\x3f\xa5\x58\x36\xe7\x69\x6f\x01"_cv,
                .iterations = 10,
                .key =
                "\xd7\xd3\x1b\xc6\x5a\x78\xd0\xc2\x56\x9c\x3b\x6c\x87\xf1\x96\xd5"
                "\x95\x0b\xd7\xcb\x6f\xcb\x7a\xc3\x80\x5d\x2b\x99\xa4\x4f\x4f\x76"
                "\x7d\x39\x57\x86\x3f\x9c\x21\x35\x92"_cv
            },
        test_vector
            {
                .id = 33,
                .ikm =
                "\x65\x33\x39\x31\x58\x9f\x91\x36\x8c\xed\xbd\x5e\x48\x64\xce\x3d"
                "\x02\x77\x2e\x01\x44\xf1\x04\xf1\xa4\x26\xca\x93\x24\x46\x8a\xcc"
                "\x9a\x85\xbc\xc3\xc5\x95\xc5\x4b\xc4\xf1"_cv,
                .salt =
                "\x44\x4c\xa8\x2a\xc9\x91\x02\x86\x01\x27\x0e\x48\x7c\x51\xa7\x74"
                "\x44\x48\xb5\x44\x98\x18\x32\x99\x4a\xe1\x0b\x68\x81\x66\x0c\x80"
                "\x96\xee\x46\x28\x4e\x31\x35\xe6\x19\xb8"_cv,
                .iterations = 10,
                .key =
                "\x8c\x3d\xb8\x2d\x52\x3b\xe5\x3a\xf3\xf8\x15\x3a\x5a\x2b\x06\x28"
                "\x50\xf7\xf8\xd0\xe4\x55\xf6\x87\x34\x6e\x22\x22\xea\x52\xfb\xc2"
                "\xa8\xf1\x63\x1b\x0b\x24\x62\x07\x20\x2f"_cv
            },
        test_vector
            {
                .id = 34,
                .ikm =
                "\xdb\xd6\x00\xdd\xc8\x97\x6a\x03\x36\xc7\xfc\xb9\x51\x33\x5b\xc7"
                "\x62\x14\xaf\xa1\x1e\xf3\x9f\xc2\xad\xf3\x80\x35\xf7\xd7\x33\x9b"
                "\x9a\xa6\xcf\x3b\x2f\xd7\x0b\xbd\xda\xa2\x06"_cv,
                .salt =
                "\x27\x86\x92\x64\x9c\x13\xd8\x1d\x21\x33\x2d\xb7\xc8\x95\x84\x39"
                "\xa6\x99\xa5\x4f\x51\x14\x5f\xbe\x03\xe3\xc6\x26\x03\x83\x70\x61"
                "\xd4\x09\x7b\x2d\x42\x4a\x0b\x00\x08\x37\x85"_cv,
                .iterations = 10,
                .key =
                "\xee\xa5\xb9\x4a\x38\x5d\x87\x99\x14\xad\x94\x54\x3a\xdd\xa1\xe3"
                "\xb6\xea\x55\xd4\x88\xd0\x37\xd8\x9c\x95\x4d\xdb\xf4\xb7\x5d\x9e"
                "\x57\x22\x41\x08\x6d\xb2\x77\x2b\xeb\x20\x43"_cv
            },
        test_vector
            {
                .id = 35,
                .ikm =
                "\x41\x59\x6d\x05\xd9\x56\xf0\x9c\x15\x35\x8e\x12\x6e\x35\x0a\xa9"
                "\xe1\xba\xe0\xf4\x7a\x43\x47\x70\x14\xa5\x42\xe9\x8f\xe6\x91\x9e"
                "\x1e\x84\xd6\x27\xd3\x24\x98\xea\xec\x27\xc7\x39"_cv,
                .salt =
                "\xa9\x8c\x04\xc0\xbd\x48\x1a\xfd\x2b\xa4\xfe\xd1\xdc\x4d\x5e\x8c"
                "\x97\xa1\x66\x56\xb1\x73\x00\x9b\x63\x3b\x86\x73\x3f\x4b\xdf\xb7"
                "\xce\xca\x9c\x7f\x2d\x3f\xc5\xd0\x86\x58\xc7\x3f"_cv,
                .iterations = 10,
                .key =
                "\xd3\x69\x80\x84\x10\x7f\x4c\xbd\x51\x8c\x9f\xbe\x7d\xff\x38\x43"
                "\x94\x58\x49\x60\x82\xf8\xda\x65\x61\x06\xd7\xcf\x44\x14\xa3\x81"
                "\x8d\x78\xd0\x78\x18\x5b\x1c\x35\xf1\xc5\xa8\xc3"_cv
            },
        test_vector
            {
                .id = 36,
                .ikm =
                "\x09\x2b\x57\xfb\x50\x18\x11\xcb\x4c\x37\xd6\x28\x2a\xaa\xbc\xa4"
                "\xcb\x8d\xcc\x3b\xdc\x26\xb5\x01\x96\xda\xd9\x07\x51\xd6\xbc\x16"
                "\x5c\x9c\xe1\x1c\x7b\x99\xf2\x2e\x39\x41\x9c\x95\x27"_cv,
                .salt =
                "\xb7\xe3\x74\x6b\xd8\x11\xca\x5d\xe8\x9b\xa7\x37\x3d\x0c\xb8\x8e"
                "\x5b\x8d\xa5\x09\x56\x1c\x69\x73\xc5\x21\x43\x1f\xed\x43\x01\xc9"
                "\x68\x9f\x0f\xb9\xb5\x03\x85\x46\x53\x1d\x0c\xd1\x7c"_cv,
                .iterations = 10,
                .key =
                "\xd0\x1c\x32\x2d\x87\x48\x35\xa2\x68\xd5\x5c\x3d\x12\xd9\x1f\x1f"
                "\x3e\x7f\x92\xa8\x8d\x66\xfd\xd0\xb0\x3d\xab\x9e\xab\x3c\x16\xa8"
                "\xcd\x23\xe7\xb1\x5f\x26\x59\xa1\x12\x51\xae\x2f\x8d"_cv
            },
        test_vector
            {
                .id = 37,
                .ikm =
                "\xcc\x0b\x7c\xfb\x75\x96\xaa\x01\x67\x51\x03\xe2\xe6\x71\x2b\xdb"
                "\xb6\x7e\x0e\x43\xed\x3c\x8e\xfd\x76\x0b\x15\x37\x6a\xff\xaf\x04"
                "\x63\x95\x71\xb5\x31\x74\xbb\x50\x6b\x45\xe6\x61\xdd\x72"_cv,
                .salt =
                "\xc2\x33\xb4\x5d\x6b\x4b\x6a\xae\x05\x27\x9e\xae\x4f\x0a\xaa\x69"
                "\x93\x90\x6b\x39\x12\x3c\xf5\x4e\x18\xa4\x38\x5d\xc1\x16\x97\xad"
                "\x49\x5a\x57\xe1\x33\x57\x82\x4b\xae\x02\x0e\x09\xbc\xb8"_cv,
                .iterations = 10,
                .key =
                "\x39\x80\x39\x5e\xb8\x24\x2e\x0c\x2e\x0b\xd7\x1b\x68\x91\x99\x4b"
                "\x12\x55\x50\xee\x4a\x2d\x37\x46\xf7\xc8\x01\x4b\xee\xa2\x18\xac"
                "\x11\xe1\xdc\xf5\x13\xb9\xcf\x52\xd0\x72\xb4\xb1\xed\xf1"_cv
            },
        test_vector
            {
                .id = 38,
                .ikm =
                "\xf8\x53\xd6\x76\x20\x34\x0b\x78\xe6\x52\xc7\xce\x0d\x96\x02\x68"
                "\x6e\x59\x34\xae\x8f\x09\x38\x11\x4c\xfa\xf1\x2e\x1d\x55\xaa\x0e"
                "\x03\xd6\x92\xcc\x03\xf3\x18\x51\x0e\x3a\xaa\x45\x75\x2d\xc8"_cv,
                .salt =
                "\x98\x12\x33\xc9\x00\x0b\x4d\xd7\xc6\x15\xe1\x8e\x87\x13\x92\x72"
                "\x01\xf9\xd0\x1e\x81\x43\x1b\x5d\x94\x63\x4d\x37\xec\x13\x07\xe8"
                "\x9a\x86\x61\xf9\x84\x5e\x3a\x76\x31\xdd\x74\xb7\x1b\x03\xb1"_cv,
                .iterations = 10,
                .key =
                "\x0f\x23\xc0\x7b\x95\x08\x34\x43\x04\x23\x2b\x86\x97\xd8\xb5\x89"
                "\x9d\xef\x6e\xd2\x42\xc3\xc3\x8c\x64\x2c\x3e\x14\x4b\x39\xa9\xc4"
                "\x93\xd7\xe4\xfb\x54\x26\x23\x6f\x7f\x4b\x66\xd3\xf1\xaf\xd8"_cv
            },
        test_vector
            {
                .id = 39,
                .ikm =
                "\x0c\x32\x55\xb4\xfc\xcc\x34\x0e\x16\x93\x99\xe6\x50\x91\xc9\x1f"
                "\x0b\xc7\x5c\x79\x79\x1e\xd6\x2a\xf7\xab\xb9\x08\x77\x4d\x11\xd8"
                "\x2d\x68\xe8\x50\x54\x5b\xf3\x05\xde\x3b\x6f\x5f\xf3\x3e\xcc\xe2"_cv,
                .salt =
                "\x6e\x1d\xe7\xd1\x7b\xd5\x02\xa0\xbe\xb2\x78\x76\x67\x12\x28\x49"
                "\x6e\xc5\x31\x2b\x50\x54\xe4\xbf\x33\xa8\xac\xd0\x0a\x07\x73\xb8"
                "\xd8\xc9\xbf\x34\x5d\x39\x9e\x79\xb8\x2e\x59\x5c\x3c\x0f\x70\x56"_cv,
                .iterations = 10,
                .key =
                "\xf5\x05\x54\xaa\x0a\x80\xfa\x6e\x5e\x74\x6c\xdc\x6d\x3e\x94\xf3"
                "\x36\xb1\x72\x20\xf9\x00\x55\x70\xd8\x61\x1d\xa1\x26\x70\x48\x8d"
                "\x38\x55\xf4\xa6\xeb\xbf\xb1\x24\xbb\x34\xb9\x79\xee\x34\xee\xb7"_cv
            },
        test_vector
            {
                .id = 40,
                .ikm =
                "\x8f\x83\xc7\x77\x96\x0b\x1e\xbc\x34\x57\x12\xe2\x63\x48\xfc\xb8"
                "\x11\x95\x66\x84\x1c\x30\xd7\x88\xce\x09\x6d\xda\x80\xd8\xa5\x06"
                "\x51\xa7\x15\xb6\x41\x76\xd9\x0e\xdc\xf5\x63\xd0\xfd\xa9\x4f\x09"
                "\x6f"_cv,
                .salt =
                "\x18\x45\x5d\x97\xcd\xab\x5e\xf1\x72\x2f\xaa\x0a\x7c\x14\x55\x5f"
                "\x17\x0d\xa8\x15\x99\x59\xbb\xe6\xd5\xf4\x3c\xf1\xdb\x92\xf4\xb5"
                "\xdc\xbe\xe1\xec\x57\x2a\x43\x41\x39\xbc\x3d\x81\xc9\xd5\xdf\x6d"
                "\x0a"_cv,
                .iterations = 10,
                .key =
                "\xd7\x4b\xd2\xcb\x78\x4a\x83\x98\x98\x0e\x31\xac\xd2\xf3\x2b\x08"
                "\x5a\xc0\x30\x2f\xa8\x30\x41\xb9\xe3\x26\x6f\x72\x99\x10\x37\xa1"
                "\x07\x8d\x39\x69\x1c\x82\x41\x2c\xbd\xcb\x15\x50\xe4\xff\x2c\x7d"
                "\x2d"_cv
            },
    };

constexpr auto
test(
) noexcept(true) -> size_t
{
    size_t test_vectors_size = test_vectors.size();
    size_t test_vectors_failed = 0;
    
    for (size_t i = 0; i < test_vectors_size; i += 1)
    {
        auto result = milo::crypto::kdf::test<milo::crypto::kdf::pbkdf_2<milo::crypto::mac::hmac<milo::crypto::hash::sha_2_256>>>::derive(
            test_vectors[i].ikm,
            test_vectors[i].salt,
            test_vectors[i].iterations,
            test_vectors[i].key
        );
        
        if (result)
        {
            continue;
        }
        
        if MILO_CONSTEVAL
        {
            return test_vectors[i].id;
        }
        else
        {
            if (test_vectors_failed == 0)
            {
                std::cerr << "Tests that failed:\n";
            }
            
            std::cerr << "  - " << test_vectors[i].id << "\n";
        }
        
        test_vectors_failed += 1;
    }
    
    return test_vectors_failed;
}

auto
main(
) noexcept(false) -> int
{
    #ifdef MILO_TESTS_CONSTEXPR
    static_assert(test() == 0);
    #endif
    
    volatile auto test_cb = test;
    
    return test_cb() > 0;
}

